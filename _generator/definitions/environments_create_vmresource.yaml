# AUTO-GENERATED by spec_to_yaml.py â€” review recommended
domain: Environments
resource: Vmresource
operation: create_vmresource
ps_verb: Add
ps_noun: Vmresource
http_method: POST
url_path: _apis/pipelines/environments/{environment_id}/providers/virtualmachines
api_version: '7.2'
docs_url: https://learn.microsoft.com/en-us/rest/api/azure/devops/environments/vmresource/add?view=azure-devops-rest-7.2
synopsis: Add Virtual Machine Resource
project_scoped: true
params:
- name: environment_id
  env_var: ENVIRONMENT_ID
  description: Id of the Environment
  required: true
- name: virtual_machine_resource
  env_var: VIRTUAL_MACHINE_RESOURCE
  description: virtualMachineResource
  required: false
  cli_flag: --virtual-machine-resource
body_fields:
- json_path: virtualMachineResource
  source: param:virtual_machine_resource
  description: virtualMachineResource
version_guard_keys:
- agent
output_mode: message
fixture_success:
  agent:
    assignedAgentCloudRequest:
      agent:
        accessPoint: {}
        enabled: {}
        id: {}
        name: {}
        osDescription: {}
        provisioningState: {}
        status: {}
      agentCloudId: 1
      agentConnectedTime: '2026-01-15T10:30:00Z'
      agentData: sample-string
      agentSpecification: sample-string
      pool:
        id: {}
        isHosted: {}
        isLegacy: {}
        name: {}
        options: {}
        poolType: {}
        scope: {}
        size: {}
      poolProvidersTags: {}
      provisionedTime: '2026-01-15T10:30:00Z'
    assignedRequest:
      agentSpecification: sample-string
      data: {}
      definition:
        id: {}
        name: {}
      demands:
      - {}
      hostId: a1b2c3d4-e5f6-7890-abcd-ef1234567890
      jobId: a1b2c3d4-e5f6-7890-abcd-ef1234567890
      jobName: sample-string
      lockedUntil: '2026-01-15T10:30:00Z'
    authorization:
      authorizationUrl: sample-string
      clientId: a1b2c3d4-e5f6-7890-abcd-ef1234567890
      publicKey:
        exponent: {}
        modulus: {}
    createdOn: '2026-01-15T10:30:00Z'
    lastCompletedRequest:
      agentSpecification: sample-string
      data: {}
      definition:
        id: {}
        name: {}
      demands:
      - {}
      hostId: a1b2c3d4-e5f6-7890-abcd-ef1234567890
      jobId: a1b2c3d4-e5f6-7890-abcd-ef1234567890
      jobName: sample-string
      lockedUntil: '2026-01-15T10:30:00Z'
    maxParallelism: 1
    pendingUpdate:
      currentState: sample-string
      reason:
        code: {}
      requestedBy:
        directoryAlias: {}
        id: {}
        imageUrl: {}
        inactive: {}
        isAadIdentity: {}
        isContainer: {}
        isDeletedInOrigin: {}
        profileUrl: {}
      requestTime: '2026-01-15T10:30:00Z'
      sourceVersion:
        major: {}
        minor: {}
        patch: {}
      targetVersion:
        major: {}
        minor: {}
        patch: {}
    properties:
      count: 1
      item: {}
      keys:
      - {}
      values:
      - {}
fixture_error_404:
  message: Vmresource not found
  typeKey: VmresourceNotFoundException
  errorCode: 0
